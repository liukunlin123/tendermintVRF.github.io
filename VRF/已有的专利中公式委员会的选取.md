


##### 选民向弱中心发送消息

选民用VRF函数生成哈希hash和证明π并进一步生成包含身份及选举轮次信息的字符串X，选民用弱中心公钥加密字符串X得到PK~中心~(X)并发送给弱中心

(PK~选民半密钥~+hash+π+seed +r)Pk~中心~

选民发给弱中心的密钥为其公钥PK~选民~的半密钥PK~选民半密钥~，这是为了确保选民被弱中心选中后，弱中心及接收到广播消息的其他选民都无法在当前阶段就知晓谁被选举为委员。弱中心此时也不知道谁是主官、谁是副官，主官和副官相互之间也不明身份。但弱中心掌握了所有委员会委员当前轮次的半密钥PK~选民半密钥~、hash和π值。在投票时，被选中的委员才会带上另一半密钥，这样才能让其他节点（主要是弱中心）验证某一票是否来自于合法的被选举出的委员

##### 弱中心盲选委员
1.弱中心等待指定的时间t后，将收到的PK~中心~(X)用私钥SK~中心~解密得到每一个选民的哈希hash和选民用VRF函数生成的证明π，计算收到哈希hash和选民用VRF函数生成的证明π的结果数量N~hash+π~（一个节点可能多次向弱中心发布消息，但是不同的节点一定会生成不同的hash值，所以根据hash值的个数来判断发送消息的选民的数量），如果结果数量N~hash+π~大于指定的数量N成立，则跳转执行步骤2；否则，跳转执行步骤1

2.弱中心随机生成一个长度为N~hash+π~的位串，且N个位为1，N~hash+π~-N位为零，其中N的值为3f+1，f为拜占庭容错的最大值（为了后续选出N个委员）

3.弱中心逐个计算长度为N~hash+π~的位串和~Nhash+π~个选民的哈希hash以及选民用VRF函数生成的证明π三者的散列哈希值，并将得到N~hash+π~个散列哈希值按照大小依次排序

4.根据长度为N~hash+π~的位串信息，按照从低位到高位的顺序，递增排列所有选民的散列哈希值，对应位为1的选民被选中为委员，确定被选中的N个委员，且被选中的N个委员中哈希值最小的委员指定为主官、其余N-1个选民为副官

5.弱中心将N个被选中委员列表信息分别生成校验值以及用私钥SK~中心~加密，N个被选中委员列表信息包括N个委员的哈希hash、选民用VRF函数生成的证明π、VRF函数种子seed以及选举轮次r，然后将加密结果以及校验值分别发送给所有选民

6.选民在收到被选中委员列表信息后，首先用弱中心的公钥PK~中心~解密字符串，然后用指定的校验算法对字符串中相同内容重生成校验值，如果两者校验值相同，则表示收到的信息未被篡改过，跳转执行步骤7；如果不同，则直接丢弃，跳转执行步骤1

7.选民将自身包含的哈希hash遍历查询N个被选中委员列表信息包括的N个委员的哈希hash，如果找到匹配的结果则判定自身被选中为委员，否则判定自身未被选中为委员

8.N个被选中委员列表信息复原长度为N~hash+π~的位串（如何恢复？），并逐个计算复原长度为N~hash+π~的位串和各个委员的哈希hash以及选民用VRF函数生成的证明π三者的散列哈希值，并将得到N~hash+π~个散列哈希值，按照大小依次排序，从而确定自身是否为主官

##### 弱中心如何验证某个节点是否为委员
向弱中心发布消息时，(PK~选民半密钥~+hash+π+seed +r)Pk~中心，~PK~选民半密钥~可以被弱中心获取

对于副官：
向弱中心给出是否认可该区块的投票的消息时：(Vote+hash +seed +r+PK’~副官半密钥~)Pk~中心~，其中Vote为副官的投票结果

副官向弱中心确认投票结果的消息时：(PK”~副官半密钥~+Commit+hash +π+seed +r)Pk~中心~，其中Commit为副官的确认消息

PK~选民半密钥~，PK’~副官半密钥~，PK”~副官半密钥~三者中的任意两者都可以生成副官的公钥

对于主官：
（主官半密钥从哪里获得？）